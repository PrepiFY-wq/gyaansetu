<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NEET Dashboard - GyaanSetu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
  />

  <style>
    :root {
      --neet-primary: #198754;
      --neet-light-bg: #f5f7fb;
    }

    body {
      background-color: var(--neet-light-bg);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI',
        Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    .sidebar {
      min-height: 100vh;
      background: linear-gradient(180deg, #198754, #05291a);
      color: #fff;
    }

    .sidebar a {
      color: #e6ffed;
      text-decoration: none;
      font-size: 0.95rem;
    }

    .sidebar a.active,
    .sidebar a:hover {
      background-color: rgba(255, 255, 255, 0.08);
      color: #fff;
    }

    .jee-card {
      border: none;
      border-radius: 0.75rem;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
      background-color: #fff;
    }

    .jee-progress {
      height: 0.45rem;
      border-radius: 999px;
    }

    .quote-box {
      border-radius: 0.75rem;
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
    }
  </style>

  <script>
    const SCRIPT_URL =
      'https://script.google.com/macros/s/AKfycbyFiEVyWCStmdOxaSz2AAboplrOXAJn0XuW614KRzLihSL60qL8zy3GEgBVvm0DQPcmQg/exec';

    // Access guard: only logged-in NEET users
    (function guardAccess() {
      const exam = localStorage.getItem('exam');
      const userId = localStorage.getItem('userId');

      if (!exam || !userId) {
        window.location.href = 'index.html';
        return;
      }
      if (exam !== 'NEET') {
        window.location.href = 'index.html';
        return;
      }
    })();
  </script>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <aside class="col-12 col-md-3 col-lg-2 sidebar p-3 d-flex flex-column">
        <div class="d-flex align-items-center mb-4">
          <div
            class="rounded-circle bg-light d-flex align-items-center justify-content-center me-2"
            style="width: 40px; height: 40px"
          >
            <span class="fw-bold text-success">N</span>
          </div>
          <div>
            <div class="fw-semibold">NEET Dashboard</div>
            <div class="small text-white-50">Target: 2026</div>
          </div>
        </div>

        <div class="mb-4">
          <div class="small text-uppercase text-white-50 mb-2">Navigation</div>
          <nav class="nav nav-pills flex-column gap-1">
            <a class="nav-link active d-flex align-items-center" href="#">
              <i class="bi bi-speedometer2 me-2"></i> Overview
            </a>
            <a class="nav-link d-flex align-items-center" href="#daily-progress">
              <i class="bi bi-clipboard-check me-2"></i> Daily Progress
            </a>
            <a class="nav-link d-flex align-items-center" href="#announcements">
              <i class="bi bi-megaphone me-2"></i> Announcements
            </a>
            <a class="nav-link d-flex align-items-center" href="#tests">
              <i class="bi bi-file-earmark-medical me-2"></i> Tests
            </a>
            <a class="nav-link d-flex align-items-center" href="#study-material">
              <i class="bi bi-journal-medical me-2"></i> Study Material
            </a>
            <a class="nav-link d-flex align-items-center" href="#path-pradarshak">
              <i class="bi bi-heart-pulse me-2"></i> पथ प्रदर्शक
            </a>
          </nav>
        </div>

        <div class="mt-auto">
          <div class="small text-uppercase text-white-50 mb-2">Target</div>
          <div class="jee-card p-3 bg-transparent border border-light">
            <div class="d-flex justify-content-between align-items-baseline">
              <span class="small text-white-50">Overall syllabus completion</span>
              <span class="small fw-semibold text-white" id="overallPercent">0%</span>
            </div>
            <div class="progress jee-progress bg-white-50 mt-2">
              <div
                class="progress-bar bg-success"
                role="progressbar"
                id="overallBar"
                style="width: 0%"
              ></div>
            </div>
            <div class="mt-3">
              <div class="d-flex justify-content-between small">
                <span class="text-white-50">Days to NEET UG 2026</span>
                <span class="text-white fw-semibold" id="daysToNeet">0 days</span>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <!-- MAIN -->
      <main class="col-12 col-md-9 col-lg-10 px-4 py-3">
        <div class="d-flex flex-wrap justify-content-between align-items-center mb-3">
          <div>
            <h4 class="mb-1">
              Welcome back, <span id="userNameHeader">Future Doctor</span>
            </h4>
            <div class="text-muted small">
              Consistent study and a calm mind crack <strong>NEET</strong>.
            </div>
          </div>
          <div class="d-flex align-items-center gap-2">
            <button class="btn btn-outline-secondary btn-sm" onclick="logout()">
              <i class="bi bi-box-arrow-right me-1"></i> Logout
            </button>
            <div
              class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center"
              style="width: 36px; height: 36px"
            >
              <span class="small fw-semibold">YOU</span>
            </div>
          </div>
        </div>

        <!-- COUNTDOWN + DAILY QUOTE -->
        <section class="jee-card p-3 mb-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div>
              <h5 class="mb-0">NEET UG 2026 Countdown</h5>
              <div class="small text-muted">
                Stay regular with Physics, Chemistry & Biology.
              </div>
            </div>
          </div>

          <div class="row g-3 align-items-center">
            <div class="col-12 col-md-6">
              <div class="row g-2">
                <div class="col-6">
                  <div class="border rounded p-3 text-center">
                    <div class="small text-muted">Days Left</div>
                    <div class="fs-3 fw-semibold" id="daysLeft">0</div>
                  </div>
                </div>
                <div class="col-6">
                  <div class="border rounded p-3 text-center">
                    <div class="small text-muted">Hours Left</div>
                    <div class="fs-3 fw-semibold" id="hoursLeft">0</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-6">
              <div class="quote-box">
                <div class="small text-success fw-semibold mb-1">
                  आज का मोटिवेशन (Quote of the Day)
                </div>
                <div id="dailyQuote" class="small">
                  Your hard work today will become someone’s heartbeat tomorrow.
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- DAILY PROGRESS INPUT -->
        <section class="jee-card p-3 mb-3" id="daily-progress">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="mb-0">Update Your Daily Progress</h5>
            <span class="small text-muted">NEET preparation tracker</span>
          </div>

          <form id="dailyProgressFormNeet" class="row g-3" onsubmit="updateProgress(event)">
            <div class="col-12 col-md-4">
              <label class="form-label small fw-semibold">Study Hours Today</label>
              <input
                type="number"
                min="0"
                step="0.5"
                class="form-control"
                id="inputStudyHoursNeet"
                placeholder="e.g. 6"
                required
              />
            </div>
            <div class="col-12 col-md-4">
              <label class="form-label small fw-semibold">Topics Covered Today</label>
              <input
                type="number"
                min="0"
                step="1"
                class="form-control"
                id="inputTopicsCoveredNeet"
                placeholder="e.g. 8"
                required
              />
            </div>
            <div class="col-12 col-md-4">
              <label class="form-label small fw-semibold">Mock Tests Completed</label>
              <input
                type="number"
                min="0"
                step="1"
                class="form-control"
                id="inputMocksCompletedNeet"
                placeholder="e.g. 1"
                required
              />
            </div>

            <div class="col-12">
              <button type="submit" class="btn btn-success btn-sm mt-1">
                <i class="bi bi-check2-circle me-1"></i> Save & Add to Totals
              </button>
            </div>
          </form>
        </section>

        <!-- TOTALS -->
        <section class="jee-card p-3 mb-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="mb-0">Overall Progress Totals</h5>
            <span class="small text-muted">Updated from daily entries</span>
          </div>
          <div class="row g-3">
            <div class="col-12 col-md-4">
              <div class="border rounded p-3 h-100">
                <div class="small text-muted mb-1">Total Study Hours</div>
                <h4 class="mb-1" id="totalStudyHoursNeet">0</h4>
                <div class="small text-muted">Physics · Chemistry · Biology</div>
              </div>
            </div>
            <div class="col-12 col-md-4">
              <div class="border rounded p-3 h-100">
                <div class="small text-muted mb-1">Total Topics Covered</div>
                <h4 class="mb-1" id="totalTopicsCoveredNeet">0</h4>
                <div class="small text-muted">NCERT + extra reference</div>
              </div>
            </div>
            <div class="col-12 col-md-4">
              <div class="border rounded p-3 h-100">
                <div class="small text-muted mb-1">Total Mock Tests</div>
                <h4 class="mb-1" id="totalMocksCompletedNeet">0</h4>
                <div class="small text-muted">Full + subject tests</div>
              </div>
            </div>
          </div>
        </section>

        <!-- ANNOUNCEMENTS -->
        <section class="jee-card p-3 mb-3" id="announcements">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="mb-0">Announcements</h5>
            <span class="small text-muted">
              NEET related updates from admin
            </span>
          </div>
          <div id="announcementsList">
            <div class="text-center text-muted small py-3">
              Admin will post important announcements here.
            </div>
          </div>
        </section>

        <!-- TESTS: PYQs & Mock PDFs -->
        <section class="jee-card p-3 mb-3" id="tests">
          <h5 class="mb-3">Tests</h5>
          <div class="row g-3">
            <div class="col-12 col-lg-6">
              <div class="border rounded p-3 h-100">
                <div class="d-flex justify-content-between mb-2">
                  <h6 class="mb-0">PYQs</h6>
                  <span class="small text-muted">Admin uploads</span>
                </div>
                <div id="pyqList">
                  <div class="text-center text-muted small py-3">
                    PYQ PDFs will appear here.
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12 col-lg-6">
              <div class="border rounded p-3 h-100">
                <div class="d-flex justify-content-between mb-2">
                  <h6 class="mb-0">Mock Tests PDFs</h6>
                  <span class="small text-muted">Offline practice</span>
                </div>
                <div id="mockPdfList">
                  <div class="text-center text-muted small py-3">
                    Mock test PDFs will appear here.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- STUDY MATERIAL -->
        <section class="jee-card p-3 mb-3" id="study-material">
          <h5 class="mb-3">Study Material</h5>
          <div class="row g-3">
            <div class="col-12 col-lg-6">
              <div class="border rounded p-3 h-100">
                <div class="d-flex justify-content-between mb-2">
                  <h6 class="mb-0">Books</h6>
                  <span class="small text-muted">Core references</span>
                </div>
                <div id="booksListNeet">
                  <div class="text-center text-muted small py-3">
                    Books list will appear here.
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12 col-lg-6">
              <div class="border rounded p-3 h-100">
                <div class="d-flex justify-content-between mb-2">
                  <h6 class="mb-0">PDFs, Notes & Others</h6>
                  <span class="small text-muted">Uploaded by admin</span>
                </div>
                <div id="notesListNeet">
                  <div class="text-center text-muted small py-3">
                    Important PDFs and notes will appear here.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- पथ प्रदर्शक -->
        <section class="jee-card p-3 mb-3" id="path-pradarshak">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="mb-0">पथ प्रदर्शक</h5>
            <span class="small text-muted">Daily motivation for NEET & MBBS dream</span>
          </div>
          <div id="pathPradarshakContent">
            <div class="border rounded p-3 bg-light">
              <p class="small mb-2">
                “जो विद्यार्थी रोज़ ईमानदारी से पढ़ता है, वही एक दिन सफेद कोट पहन कर
                मरीजों की सेवा करता है। आज की मेहनत, कल किसी की जान बचाएगी।”
              </p>
              <p class="small mb-0">
                Mobile से ज़्यादा समय किताबों को दें। हर 50 मिनट की पढ़ाई के बाद छोटा
                ब्रेक लें और वापिस बैठ जाएँ। आपका निरंतर प्रयास ही आपकी
                <strong>ताकत</strong> है।
              </p>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // NEET quotes of the day [web:170][web:157]
    const neetQuotes = [
      'Your hard work today will become someone’s heartbeat tomorrow.',
      'हर पेज जो आप आज पढ़ते हैं, कल किसी मरीज की जान बचा सकता है।',
      'Consistent NCERT revision beats last-minute panic always.',
      'एक-एक chapter मजबूत बनाते रहो, पूरी MBBS की नींव यहीं से शुरू होती है।',
      'Discipline in study hours is your real coaching.'
    ];

    function loadDailyQuote() {
      const todayKey = new Date().toISOString().slice(0, 10); // YYYY-MM-DD
      const stored = localStorage.getItem('neetQuote');
      let quote;

      if (stored) {
        const parsed = JSON.parse(stored);
        if (parsed.date === todayKey) {
          quote = parsed.text;
        }
      }

      if (!quote) {
        quote = neetQuotes[Math.floor(Math.random() * neetQuotes.length)];
        localStorage.setItem(
          'neetQuote',
          JSON.stringify({ date: todayKey, text: quote })
        );
      }

      document.getElementById('dailyQuote').textContent = quote;
    }

    function updateCountdown() {
      // Example NEET 2026 tentative date (update when official) [web:167]
      const examDate = new Date('2026-05-03T09:00:00');
      const now = new Date();
      const diff = examDate - now;

      const days = Math.max(0, Math.floor(diff / (1000 * 60 * 60 * 24)));
      const hours = Math.max(0, Math.floor(diff / (1000 * 60 * 60)));

      document.getElementById('daysLeft').textContent = days;
      document.getElementById('hoursLeft').textContent = hours;
      document.getElementById('daysToNeet').textContent = `${days} days`;
    }

    function logout() {
      if (confirm('Logout from GyaanSetu?')) {
        localStorage.removeItem('userId');
        localStorage.removeItem('name');
        localStorage.removeItem('exam');
        window.location.href = 'index.html';
      }
    }

    // STUDY PROGRESS (same backend pattern as UPSC/JEE) [web:169][web:178]
    function updateProgress(e) {
      e.preventDefault();

      const userId = localStorage.getItem('userId');
      const exam = localStorage.getItem('exam');

      if (!userId || !exam) {
        alert('Session expired. Please login again.');
        window.location.href = 'index.html';
        return;
      }

      const hours =
        parseFloat(document.getElementById('inputStudyHoursNeet').value) || 0;
      const topics =
        parseInt(
          document.getElementById('inputTopicsCoveredNeet').value || '0',
          10
        ) || 0;
      const mocks =
        parseInt(
          document.getElementById('inputMocksCompletedNeet').value || '0',
          10
        ) || 0;

      const url =
        `${SCRIPT_URL}?action=logStudy` +
        `&userId=${encodeURIComponent(userId)}` +
        `&exam=${encodeURIComponent(exam)}` +
        `&hours=${encodeURIComponent(hours)}` +
        `&topics=${encodeURIComponent(topics)}` +
        `&mocks=${encodeURIComponent(mocks)}`;

      fetch(url)
        .then((r) => r.json())
        .then((data) => {
          if (!data.success) {
            throw new Error(data.message || 'Failed to save study log');
          }
          const totalsUrl =
            `${SCRIPT_URL}?action=getStudyTotals` +
            `&userId=${encodeURIComponent(userId)}` +
            `&exam=${encodeURIComponent(exam)}`;
          return fetch(totalsUrl).then((r) => r.json());
        })
        .then((totals) => {
          if (totals && totals.success) {
            document.getElementById('totalStudyHoursNeet').textContent =
              totals.totalHours || 0;
            document.getElementById('totalTopicsCoveredNeet').textContent =
              totals.totalTopics || 0;
            document.getElementById('totalMocksCompletedNeet').textContent =
              totals.totalMocks || 0;
          }
          alert('Progress updated successfully!');
          document.getElementById('dailyProgressFormNeet').reset();
        })
        .catch((err) => {
          console.error('Update progress error:', err);
          alert('Error updating progress. Please try again.');
        });
    }

    function loadTotals() {
      const userId = localStorage.getItem('userId');
      const exam = localStorage.getItem('exam');
      if (!userId || !exam) return;

      const totalsUrl =
        `${SCRIPT_URL}?action=getStudyTotals` +
        `&userId=${encodeURIComponent(userId)}` +
        `&exam=${encodeURIComponent(exam)}`;

      fetch(totalsUrl)
        .then((r) => r.json())
        .then((totals) => {
          if (totals && totals.success) {
            document.getElementById('totalStudyHoursNeet').textContent =
              totals.totalHours || 0;
            document.getElementById('totalTopicsCoveredNeet').textContent =
              totals.totalTopics || 0;
            document.getElementById('totalMocksCompletedNeet').textContent =
              totals.totalMocks || 0;
          }
        })
        .catch((err) => console.error('Load totals error:', err));
    }

    window.onload = function () {
      document.getElementById('userNameHeader').textContent =
        localStorage.getItem('name') || 'Future Doctor';

      updateCountdown();
      setInterval(updateCountdown, 60 * 60 * 1000);

      loadDailyQuote();
      loadTotals();
    };
  </script>
</body>
</html>
